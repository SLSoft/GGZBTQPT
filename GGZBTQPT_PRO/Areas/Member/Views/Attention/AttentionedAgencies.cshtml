@model Webdiyer.WebControls.Mvc.PagedList<GGZBTQPT_PRO.Areas.ViewModels.VM_AttentionedAgency>

@helper HasAttentioned(GGZBTQPT_PRO.Models.T_HY_Member attentioned_member, int current_member_id, GGZBTQPT_PRO.Models.T_JG_Agency attentioned_Agency)
{
    if (attentioned_member.Attentions.Select(a => a.AttentionedMemberID == current_member_id).Count() > 0 )
    {
        <span class="phone">固定电话：@attentioned_Agency.Phone</span><span class="email">地址：@attentioned_Agency.Address</span>    }
    else
    {
         <p>
        <span class="label label-important">****以下信息互相关注后可见****</span></p>
    <span class="phone">固定电话：********</span><span class="email">地址：********</span> 
    }
} 

<script type="text/javascript">
    function notice(data) {
        $("#attentioned li.active a").click();
        $.Member.notice(data);
    }
    $.Member.replaceBlankForMVCPager();
</script>
<div id="attentioned">
    @foreach (var _model in Model)
    {
        <div class="attentioned-content row-fluid">
            @*关注的创业者的头像和基本信息*@
            <div class="attentioned-link span2">
                <div class="unattentioned">
                    <span><i class="icon-eye-close icon-white"></i>@Ajax.ActionLink("取消关注", "UnAttentioned", "Attention", new { id = _model.Agency.MemberID }, new AjaxOptions { HttpMethod = "post", OnSuccess = "notice" })</span>
                </div>
            </div>
            @*完整信息*@
            <div class="person-detail span10">
                @*可见信息*@
                <h4>
                    @_model.Agency.AgencyName</h4>
                <div class="base-detail">
                <div>
                    <label>机构类型：<span>@_model.Agency.AgencyTypeName</span></label>
                    <label>所在城市：<span>@_model.Agency.City</span></label>
                    <label>注册资金：<span>@_model.Agency.RegCapital</span></label>
                    <label>机构介绍:</label>
                    <p>@_model.Agency.Remark</p>
                    <label>服务介绍:</label>
                    <p>@_model.Agency.Services</p>
                </div> 
                </div>
                @*隐私信息*@
                <div class="privacy-detail">
                   @HasAttentioned(_model.Member,ViewBag.CurrentMemberID, _model.Agency)
                </div>
            </div>
        </div>
    }
    <div class="pagination pagination-left clear">
        @Html.AjaxPager(Model, new PagerOptions { PageIndexParameterName = "id", ContainerTagName = "ul", CurrentPagerItemWrapperFormatString = "<li class='active'><a href='#'>{0}</a></li>", PagerItemWrapperFormatString = "<li>{0}</li>" }, new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "details" }) 
    </div>
</div>

